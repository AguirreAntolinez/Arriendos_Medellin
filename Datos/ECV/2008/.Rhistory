Migrante_Otra_Razo_Total=sum(faestrat[Migrante_Otra_Razon==1]),
Promedio_Years_in_Medellin=mean(Years_in_Medellin),
Promedio_Proporcion_Viviendo_Medellin=mean(Proporcion_Viviendo_Medellin))
View(variables_personas)
variables_personas<-data %>%
group_by(barrio) %>%
summarise(
Base_Personas=nrow(noform)
Poblacion_Total=sum(faestrat),
variables_personas<-data %>%
group_by(barrio) %>%
summarise(
Base_Personas=nrow(noform),
Poblacion_Total=sum(faestrat),
Pigrantes_Total=sum(faestrat[Migrante==1]),
Migrante_Internacional_Total=sum(faestrat[Migrante_Internacional==1]),
Migrante_Intermunicipal_Total=sum(faestrat[Migrante_Intermunicipal==1]),
Migrante_Violencia_Total=sum(faestrat[Migrante_Violencia==1]),
Migrante_Estudio_Total=sum(faestrat[Migrante_Estudio==1]),
Migrante_Trabajo_Total=sum(faestrat[Migrante_Trabajo==1]),
Migrante_Venta_De_Tierra_Total=sum(faestrat[Migrante_Venta_De_Tierra==1]),
Migrante_Razones_Familiares_Total=sum(faestrat[Migrante_Razones_Familiares==1]),
Migrante_Fenomeno_Natural_Total=sum(faestrat[Migrante_Fenomeno_Natural==1]),
Migrante_Otra_Razo_Total=sum(faestrat[Migrante_Otra_Razon==1]),
Promedio_Years_in_Medellin=mean(Years_in_Medellin),
Promedio_Proporcion_Viviendo_Medellin=mean(Proporcion_Viviendo_Medellin))
variables_personas<-data %>%
group_by(barrio) %>%
summarise(
Base_Personas=nrow(noform),
Poblacion_Total=sum(faestrat),
Pigrantes_Total=sum(faestrat[Migrante==1]),
Migrante_Internacional_Total=sum(faestrat[Migrante_Internacional==1]),
Migrante_Intermunicipal_Total=sum(faestrat[Migrante_Intermunicipal==1]),
Migrante_Violencia_Total=sum(faestrat[Migrante_Violencia==1]),
Migrante_Estudio_Total=sum(faestrat[Migrante_Estudio==1]),
Migrante_Trabajo_Total=sum(faestrat[Migrante_Trabajo==1]),
Migrante_Venta_De_Tierra_Total=sum(faestrat[Migrante_Venta_De_Tierra==1]),
Migrante_Razones_Familiares_Total=sum(faestrat[Migrante_Razones_Familiares==1]),
Migrante_Fenomeno_Natural_Total=sum(faestrat[Migrante_Fenomeno_Natural==1]),
Migrante_Otra_Razo_Total=sum(faestrat[Migrante_Otra_Razon==1]),
Promedio_Years_in_Medellin=mean(Years_in_Medellin),
Promedio_Proporcion_Viviendo_Medellin=mean(Proporcion_Viviendo_Medellin))
View(variables_personas)
Base_Personas=nrow(noform)
variables_personas<-data %>%
group_by(barrio) %>%
summarise(
Base_Personas=nrow(noform),
Poblacion_Total=sum(faestrat),
Migrantes_Total=sum(faestrat[Migrante==1]),
Migrante_Internacional_Total=sum(faestrat[Migrante_Internacional==1]),
Migrante_Intermunicipal_Total=sum(faestrat[Migrante_Intermunicipal==1]),
Migrante_Violencia_Total=sum(faestrat[Migrante_Violencia==1]),
Migrante_Estudio_Total=sum(faestrat[Migrante_Estudio==1]),
Migrante_Trabajo_Total=sum(faestrat[Migrante_Trabajo==1]),
Migrante_Venta_De_Tierra_Total=sum(faestrat[Migrante_Venta_De_Tierra==1]),
Migrante_Razones_Familiares_Total=sum(faestrat[Migrante_Razones_Familiares==1]),
Migrante_Fenomeno_Natural_Total=sum(faestrat[Migrante_Fenomeno_Natural==1]),
Migrante_Otra_Razo_Total=sum(faestrat[Migrante_Otra_Razon==1]),
Promedio_Years_in_Medellin=mean(Years_in_Medellin),
Promedio_Proporcion_Viviendo_Medellin=mean(Proporcion_Viviendo_Medellin))
View(variables_personas)
data<-data %>% mutate(base_encuestas=1)
View(data)
#Base de encuestas
data<-data %>% mutate(base_encuestas=1)
variables_personas<-data %>%
group_by(barrio) %>%
summarise(
Base_Personas=sum(base_encuestas),
Poblacion_Total=sum(faestrat),
Migrantes_Total=sum(faestrat[Migrante==1]),
Migrante_Internacional_Total=sum(faestrat[Migrante_Internacional==1]),
Migrante_Intermunicipal_Total=sum(faestrat[Migrante_Intermunicipal==1]),
Migrante_Violencia_Total=sum(faestrat[Migrante_Violencia==1]),
Migrante_Estudio_Total=sum(faestrat[Migrante_Estudio==1]),
Migrante_Trabajo_Total=sum(faestrat[Migrante_Trabajo==1]),
Migrante_Venta_De_Tierra_Total=sum(faestrat[Migrante_Venta_De_Tierra==1]),
Migrante_Razones_Familiares_Total=sum(faestrat[Migrante_Razones_Familiares==1]),
Migrante_Fenomeno_Natural_Total=sum(faestrat[Migrante_Fenomeno_Natural==1]),
Migrante_Otra_Razo_Total=sum(faestrat[Migrante_Otra_Razon==1]),
Promedio_Years_in_Medellin=mean(Years_in_Medellin),
Promedio_Proporcion_Viviendo_Medellin=mean(Proporcion_Viviendo_Medellin))
View(tabla)
View(variables_personas)
View(ECV_2004)
data_jefes<-ECV_2004 %>% filter(p33==1)
table(data$p33)
table(ECV_2004$p33)
table(ECV_2004$p17)
data_jefes<-ECV_2004 %>% filter(p33=='Jefe del hogar')
data_hogares<-ECV_2004 %>% filter(p33=='Jefe del hogar')
data_viviendas<-data_hogares %>% distinct(noform, .keep_all=TRUE)
View(variables_personas)
table(data_viviendas$estrato)
#Seleccionar las variables de interes####
data_viviendas<-data_viviendas %>% select(
noform,
comuna,
estrato,
barrio,
vvienda,
area,
p2,
p3,
p4,
p5,
p6_1,
p6_2,
p6_3,
p6_4,
p6_5,
p6_7,
p6_8,
p14_1,
p14_2,
p14_3,
p14_4,
p14_5,
p14_6,
p14_7,
p15,
p16,
p17,
orden)
table(data_viviendas$p3)
table(data_viviendas$p2)
# Tipos de construcciones
data_viviendas<-data_viviendas %>% mutate(
Apartamento=case_when(p2=='Apartamento'~1,.default = 0),
Casa=case_when(p2=='Casa'~1,.default = 0),
Cuarto=case_when(p2=='Cuarto(S)'~1,.default = 0),
Rancho_Vivienda_De_Desechos=case_when(p2=='Rancho o vivienda de desechos'~1,.default = 0),
No_Desintado_Para_Habitacion=case_when(p2=='Vivienda en edificación no destinada para habitación'~1,.default = 0),
)
table(data_viviendas$Apartamento)
table(data_viviendas$Casa)
table(data_viviendas$Cuarto)
table(data_viviendas$Rancho_Vivienda_De_Desechos)
table(data_viviendas$No_Desintado_Para_Habitacion)
# Tipos de construcciones
data_viviendas<-data_viviendas %>% mutate(
Apartamento=case_when(p2=='Apartamento'~1,.default = 0),
Casa=case_when(p2=='Casa'~1,.default = 0),
Cuarto=case_when(p2=='Cuarto(S)'~1,.default = 0),
Rancho_Vivienda_De_Desechos=case_when(p2=='Rancho o vivienda de desechos'~1,.default = 0),
En_Construccion_No_Desintado_Para_Habitacion=case_when(p2=='Vivienda en edificación no destinada para habitación'~1,.default = 0),
)
# Tipos de construcciones
data_viviendas<-data_viviendas %>% mutate(
Apartamento=case_when(p2=='Apartamento'~1,.default = 0),
Casa=case_when(p2=='Casa'~1,.default = 0),
Cuarto=case_when(p2=='Cuarto(S)'~1,.default = 0),
Rancho_Vivienda_De_Desechos=case_when(p2=='Rancho o vivienda de desechos'~1,.default = 0),
Edificacion_No_Desintada_Para_Habitacion=case_when(p2=='Vivienda en edificación no destinada para habitación'~1,.default = 0),
)
# Tipos de construcciones
data_viviendas<-data_viviendas %>% mutate(
Apartamento=case_when(p2=='Apartamento'~1,.default = 0),
Casa=case_when(p2=='Casa'~1,.default = 0),
Cuarto=case_when(p2=='Cuarto(S)'~1,.default = 0),
Rancho_Vivienda_De_Desechos=case_when(p2=='Rancho o vivienda de desechos'~1,.default = 0),
Edificacion_No_Desintada_Para_Habitacion=case_when(p2=='Vivienda en edificación no destinada para habitación'~1,.default = 0)
)
table(data_viviendas$p3)
table(data_viviendas$p6_1)
data_viviendas<-data_viviendas %>% mutate(
Paredes_Precarias=case_when(
p3=='Ladrillo - Bloque - Adobe revocado y pintado' |
p3=='Ladrillo - Bloque Forrado en piedra, madera' ~0, .default = 1),
Pisos_Precarios=case_when(
p4=='Baldosa, vinilo, tableta o ladrillo' |
p4=='Alfombra o tapete de pared a pared, mármol, parqué,  Madera' ~0, .default = 1),
Sin_Energia=case_when(p6_1=='Si posee' ~0, .default = 1),
Sin_Acueducto=case_when(p6_2=='Si posee' ~0, .default = 1),
Sin_Alcantarillado=case_when(p6_3=='Si posee' ~0, .default = 1),
Sin_Gas_Natural=case_when(p6_5=='Si posee' ~0, .default = 1),
Sin_Internet=case_when(p6_7=='Si posee' ~0, .default = 1),
Precariedad_Vivienda=
Paredes_Precarias+
Pisos_Precarios+
Sin_Energia+
Sin_Acueducto+
Sin_Alcantarillado+
Sin_Gas_Natural+
Sin_Internet
)
data_viviendas<-data_viviendas %>% mutate(
Paredes_Precarias=case_when(
p3=='Ladrillo - Bloque - Adobe revocado y pintado' |
p3=='Ladrillo - Bloque Forrado en piedra, madera' ~0, .default = 1),
Pisos_Precarios=case_when(
p4=='Baldosa, vinilo, tableta o ladrillo' |
p4=='Alfombra o tapete de pared a pared, mármol, parqué,  Madera' ~0, .default = 1),
Sin_Energia=case_when(p6_1=='Si posee' ~0, .default = 1),
Sin_Acueducto=case_when(p6_2=='Si posee' ~0, .default = 1),
Sin_Alcantarillado=case_when(p6_3=='Si posee' ~0, .default = 1),
Sin_Gas_Natural=case_when(p6_5=='Si posee' ~0, .default = 1),
Sin_Internet=case_when(p6_7=='Si posee' ~0, .default = 1),
Precariedad_Sanitario=case_when(p15=='Inodoro conectado a alcantarillado' ~0, .default =1),
Precariedad_Vivienda=
Paredes_Precarias+
Pisos_Precarios+
Sin_Energia+
Sin_Acueducto+
Sin_Alcantarillado+
Sin_Gas_Natural+
Sin_Internet+
Precariedad_Sanitario
)
#Base de viviendas
data_viviendas<-data_viviendas %>% mutate(base_viviendas=1)
# Tipos de construcciones
data_viviendas<-data_viviendas %>% mutate(
Apartamento=case_when(p2=='Apartamento'~1,.default = 0),
Casa=case_when(p2=='Casa'~1,.default = 0),
Cuarto=case_when(p2=='Cuarto(S)'~1,.default = 0),
Rancho_Vivienda_De_Desechos=case_when(p2=='Rancho o vivienda de desechos'~1,.default = 0),
Edificacion_No_Desintada_Para_Habitacion=case_when(p2=='Vivienda en edificación no destinada para habitación'~1,.default = 0)
)
variables_viviendas<-data_viviendas %>%
group_by(barrio) %>%
summarise(
Base_Viviendas=sum(base_viviendas),
Apartamentos=sum(Apartamento),
Casa=sum(Casa),
Cuarto=sum(Cuarto),
Rancho_Vivienda_De_Desechos=sum(Rancho_Vivienda_De_Desechos),
Edificacion_No_Desintada_Para_Habitacion=sum(Edificacion_No_Desintada_Para_Habitacion),
Paredes_Precarias=sum(Paredes_Precarias),
Pisos_Precarios=sum(Pisos_Precarios),
Sin_Energia=sum(Sin_Energia),
Sin_Acueducto=sum(Sin_Acueducto),
Sin_Alcantarillado=sum(Sin_Alcantarillado),
Sin_Gas_Natural=sum(Sin_Gas_Natural),
Sin_Internet=sum(Sin_Internet),
Precariedad_Sanitario=sum(Precariedad_Sanitario),
Promedio_Precariedad=mean(Precariedad_Vivienda))
##### CREAR VARIABLES HOGARES ####
#Seleccionar las variables de interes
data_hogares<-data_hogares %>% select(
noform,
comuna,
estrato,
barrio,
area,
p14_6,
no_hogar,
p17,
p18_1,
p18_2,
p18_3,
p18_4,
p18_5,
p18_6,
p18_7,
p22,
p23,
orden
)
#Vivienda en arriendo
data_hogares<-data_hogares %>% mutate(
Vivienda_Arriendo=case_when(p22=='En Arriendo O Subarriendo'~1,.default = 0))
table(data_hogares$Vivienda_Arriendo)
data %>% group_by(noform) %>% summarise(total_personas_hogar=sum(base_encuestas))
Poblacion_Hogar<-data %>% group_by(noform) %>% summarise(total_personas_vivienda=sum(base_encuestas))
View(Poblacion_Hogar)
data_viviendas<-data_viviendas %>% left_join(Poblacion_Hogar.by='noform')
View(data_viviendas)
data_viviendas<-data_viviendas %>% left_join(Poblacion_Hogar,by='noform')
table(is.na(data_viviendas$total_personas_vivienda))
View(data_viviendas)
View(data_viviendas)
data_viviendas<-data_viviendas %>% mutate(
Paredes_Precarias=case_when(
p3=='Ladrillo - Bloque - Adobe revocado y pintado' |
p3=='Ladrillo - Bloque Forrado en piedra, madera' ~0, .default = 1),
Pisos_Precarios=case_when(
p4=='Baldosa, vinilo, tableta o ladrillo' |
p4=='Alfombra o tapete de pared a pared, mármol, parqué,  Madera' ~0, .default = 1),
Sin_Energia=case_when(p6_1=='Si posee' ~0, .default = 1),
Sin_Acueducto=case_when(p6_2=='Si posee' ~0, .default = 1),
Sin_Alcantarillado=case_when(p6_3=='Si posee' ~0, .default = 1),
Sin_Gas_Natural=case_when(p6_5=='Si posee' ~0, .default = 1),
Sin_Internet=case_when(p6_7=='Si posee' ~0, .default = 1),
Precariedad_Sanitario=case_when(p15=='Inodoro conectado a alcantarillado' ~0, .default =1),
Precariedad_Hacinamiento=case_when(total_personas_vivienda/p14_6>3 ~1,.default = 0),
Precariedad_Vivienda=
Paredes_Precarias+
Pisos_Precarios+
Sin_Energia+
Sin_Acueducto+
Sin_Alcantarillado+
Sin_Gas_Natural+
Sin_Internet+
Precariedad_Sanitario+
Precariedad_Hacinamiento
)
table(data_viviendas$Precariedad_Hacinamiento)
#Base de viviendas
data_viviendas<-data_viviendas %>% mutate(base_viviendas=1)
variables_viviendas<-data_viviendas %>%
group_by(barrio) %>%
summarise(
Base_Viviendas=sum(base_viviendas),
Apartamentos=sum(Apartamento),
Casa=sum(Casa),
Cuarto=sum(Cuarto),
Rancho_Vivienda_De_Desechos=sum(Rancho_Vivienda_De_Desechos),
Edificacion_No_Desintada_Para_Habitacion=sum(Edificacion_No_Desintada_Para_Habitacion),
Paredes_Precarias=sum(Paredes_Precarias),
Pisos_Precarios=sum(Pisos_Precarios),
Sin_Energia=sum(Sin_Energia),
Sin_Acueducto=sum(Sin_Acueducto),
Sin_Alcantarillado=sum(Sin_Alcantarillado),
Sin_Gas_Natural=sum(Sin_Gas_Natural),
Sin_Internet=sum(Sin_Internet),
Precariedad_Sanitario=sum(Precariedad_Sanitario),
Precariedad_Hacinamiento=sum(Precariedad_Hacinamiento),,
Promedio_Precariedad=mean(Precariedad_Vivienda))
data_hogares<-data_hogares %>% mutate(base_hogares=1)
mean(data_hogares$p23)
variables_hogares<-data_hogares %>%
group_by(barrio) %>%
summarise(
Base_Hogares=sum(base_hogares),
Vivienda_Arriendo=sum(Vivienda_Arriendo),
Promedio_Viviendo_En_Vivienda=mean(p23),
Estrato_Promedio=mean(estrato))
View(variables_viviendas)
#Armar la data
data_hogares<-data_hogares %>% mutate(base_hogares=1)
variables_hogares<-data_hogares %>%
group_by(barrio) %>%
summarise(
Base_Hogares=sum(base_hogares),
Hogares_Viviendo_Arriendo=sum(Vivienda_Arriendo),
Promedio_Hogar_Viviendo_En_Vivienda=mean(p23),
Estrato_Promedio=mean(estrato))
View(variables_hogares)
4+14+16
variables<-variables_personas %>%
left_join(variables_viviendas, by='barrio') %>%
left_join(variables_hogares, by='barrio')
View(variables)
variables<-variables %>% mutate(Medicion=2004)
View(variables)
writexl::write_xlsx(variables,"C:/Users/HP-Laptop/OneDrive - Universidad de Antioquia/Maestría en Economía/Tesis/1. Procesamiento/Data/DATOS ECV/Alcaldia de Medellín/Preprocesados/Variables_ECV_2004.xlsx")
names(variables)
as.data.frame(names(variables))
tabla<-as.data.frame(names(variables))
View(tabla)
library(tidyverse)
library(ggridges)
install.packages("ggridges")
library(tidyverse)
library(ggridges)
library(broom)
library(faux)
install.packages("faux")
library(tidyverse)
library(ggridges)
library(broom)
library(faux)
set.seed(1234)
N<- 1000000
income_aut<-100
effect<-10
df<-tibble(
educ=rnorm(N,mean=11,sd=9),
u=rnorm(N,mean=0,sd=36),
income=income_aut+ effect+u) %>%
mutate(
niv_edu=case_when(educ<=5 ~ 0, # "sin educacion"
educ >5 & educ <=9~ 5,
educ >9 & educ <=11~ 9,
educ >11 & educ <=16~ 11,
educ >16 & educ <=18~ 16,
educ >18 & educ <=20~ 18,
educ >20 ~ 20)
)
View(df)
mean(df$educ)
mean(df$U)
mean(df$u)
mean(df$educ)
mean(df$income)
sd(df$educ)
sd(df$u)
sd(df$niv_edu)
sd(df$income)
11+5+2+1
ggplot(df)+
geom_histogram(aes(income), bins=100, color="white", fill="green", alpha=0.5)+
geom_histogram(aes(educ), bins=100, color="white", fill="orange", alpha=0.5)+
geom_histogram(aes(u), bins=100, color="white", fill="blue", alpha=0.5)+
theme_minimal()
df %>% ggplot() +
geom_histogram(aes(income), bins=100, color="white", fill="green", alpha=0.5)+
geom_histogram(aes(educ), bins=100, color="white", fill="orange", alpha=0.5)+
geom_histogram(aes(u), bins=100, color="white", fill="blue", alpha=0.5)+
theme_minimal()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_classic()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_dark()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_linedraw()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_bw()
library(ggthemes)
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_stata()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_economist()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_economist_white()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_excel()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_base()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_gdocs()
df %>% ggplot()+
aes(x=u,y=niv_edu, group = niv_edu)+
geom_density_ridges(alpha=0.3)+
coord_flip()+
theme_clean()
n_sample=10000
reg<-list()
for(i in (1:1000)){
df_sample<-df[sample(nrow(df),n_sample),]
reg[[i]]<-lm(income~educ, data=df_sample) %>%
tidy(conf.int=TRUE) %>%
filter(term=="educ") %>%
select(~term)
}
for(i in (1:1000)){
df_sample<-df[sample(nrow(df),n_sample),]
reg[[i]]<-lm(income~educ, data=df_sample) %>%
tidy(conf.int=TRUE) %>%
filter(term=="educ") %>%
select(-term)
}
View(reg)
reg<- bind_rows(reg) %>%
rownames_to_column(var="reg")
media<-mean(reg$estimate, na.rm = TRUE)
reg %>% ggplot() +
geom_histogram(aes(estimate), bins=100, color="white", fill="green", alpha=0.5)+
theme(minimal)
reg %>% ggplot() +
geom_histogram(aes(estimate), bins=100, color="white", fill="green", alpha=0.5)+
theme_minimal()
reg %>% ggplot() +
geom_histogram(aes(estimate), bins=100, color="white", fill="green", alpha=0.5)+
geom_line(aes(media))+
theme_minimal()
reg %>% ggplot() +
geom_histogram(aes(estimate), bins=100, color="white", fill="green", alpha=0.5)+
theme_minimal()
library(readxl)
data <- read_excel("C:/Users/HP-Laptop/Downloads/Base de datos Encuesta Calidad de Vida 2008.xlsx")
View(data)
setwd("C:/Users/HP-Laptop/OneDrive - Universidad de Antioquia/Maestría en Economía/Tesis/1. Procesamiento/Arriendos_Medellin/Datos/ECV/2008")
# Definir el tamaño del bloque
tamaño_bloque <- 9500
# Calcular el número total de bloques
n_bloques <- ceiling(nrow(data) / tamaño_bloque)
# Dividir los datos y guardarlos en archivos CSV
for (i in seq_len(n_bloques)) {
# Definir el índice inicial y final para cada bloque
inicio <- (i - 1) * tamaño_bloque + 1
fin <- min(i * tamaño_bloque, nrow(data))
# Extraer el bloque
bloque <- data[inicio:fin, ]
# Definir el nombre del archivo CSV
nombre_archivo <- sprintf("ECV_2008_%03d.csv", i)
# Guardar el bloque en un archivo CSV con codificación UTF-8
write.csv(bloque, nombre_archivo, row.names = FALSE, fileEncoding = "UTF-8")
}
